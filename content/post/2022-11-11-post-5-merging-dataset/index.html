---
title: Merging Datasets
author: Guanchen Xiao, Fangzhou Cheng, Zehao Zhou, Yuke Li, Xuzhan Tan
date: '2022-11-11'
slug: []
categories: []
tags: []
description: ~
toc: yes
authors: []
series: []
lastmod: '2022-11-11T20:57:26-05:00'
featuredVideo: ~
featuredImage: ~
---


<div id="TOC">

</div>

<p>We found a dataset from the website of the Centers for Medicare and Medicaid Services (CMS). <a href="https://data.cms.gov/summary-statistics-on-use-and-payments/medicare-premium-reports/cms-program-statistics-medicare-premiums" class="uri">https://data.cms.gov/summary-statistics-on-use-and-payments/medicare-premium-reports/cms-program-statistics-medicare-premiums</a> . This dataset summarized information on medicare premium beneficiaries and amounts by yearly trend, demographics and geography. We picked the data from 2020, which is same as our initial dataset. We guess there might be some relationship between discharge and premium.</p>
<p>##Output 1</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.0      ✔ stringr 1.4.1 
## ✔ readr   2.1.2      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>medicare_data &lt;- read_csv(here::here(&quot;dataset&quot;, &quot;Medicare_Data.csv&quot;) , 
col_types = cols( Avg_Mdcr_Pymt_Amt=col_number(), Avg_Tot_Pymt_Amt=col_number(), Avg_Submtd_Cvrd_Chrg=col_number()))
medicare_data_clean &lt;- medicare_data %&gt;% 
filter(!grepl(&#39;Unknown&#39;, medicare_data$Rndrng_Prvdr_RUCA_Desc)) %&gt;%
   drop_na() %&gt;%      
select(-Rndrng_Prvdr_CCN, -Rndrng_Prvdr_St, -Rndrng_Prvdr_State_FIPS, -Rndrng_Prvdr_Zip5, -Rndrng_Prvdr_RUCA_Desc)
(medicare_data_sum &lt;- medicare_data_clean %&gt;%
  group_by(Rndrng_Prvdr_State_Abrvtn) %&gt;%
  summarize(Mean_Discharge = mean(Tot_Dschrgs), Mean_Covered = mean(Avg_Submtd_Cvrd_Chrg), Mean_Total_Payment = mean(Avg_Tot_Pymt_Amt), Mean_Medicare_Payment = mean(Avg_Mdcr_Pymt_Amt)))</code></pre>
<pre><code>## # A tibble: 51 × 5
##    Rndrng_Prvdr_State_Abrvtn Mean_Discharge Mean_Covered Mean_Total_Pa…¹ Mean_…²
##    &lt;chr&gt;                              &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;   &lt;dbl&gt;
##  1 AK                                  28.9      114661.          24284.  20744.
##  2 AL                                  33.5       66193.          13156.  10637.
##  3 AR                                  34.8       51085.          12931.  11166.
##  4 AZ                                  31.9       89736.          16744.  14281.
##  5 CA                                  33.7      128218.          21425.  18811.
##  6 CO                                  29.8      109313.          17936.  15281.
##  7 CT                                  37.3       60092.          18871.  15676.
##  8 DC                                  35.3      110420.          25532.  19320.
##  9 DE                                  45.8       49655.          16025.  13095.
## 10 FL                                  36.9       92665.          13998.  11935.
## # … with 41 more rows, and abbreviated variable names ¹​Mean_Total_Payment,
## #   ²​Mean_Medicare_Payment</code></pre>
<p>##Output 2</p>
<pre class="r"><code>library(tidyverse)
premiumA &lt;- read_csv(here::here(&quot;dataset&quot;, &quot;PremiumA.csv&quot;), col_types = cols(Total_Premium_Amount =col_number(),  Reduced_Base_Premium_Amount=col_number(), Standard_Base_Premium_Amount = col_number()))
(medicare_premium_combined &lt;- merge(premiumA,medicare_data_sum))</code></pre>
<pre><code>##    Rndrng_Prvdr_State_Abrvtn Total_Premium_Number_of_Beneficiaries
## 1                         AK                                   663
## 2                         AL                                  2491
## 3                         AR                                  2373
## 4                         AZ                                  4108
## 5                         CA                                187725
## 6                         CO                                  1034
## 7                         CT                                  2719
## 8                         DC                                  2056
## 9                         DE                                   745
## 10                        FL                                105020
## 11                        GA                                  2516
## 12                        HI                                  3692
## 13                        IA                                  3084
## 14                        ID                                   566
## 15                        IL                                  5274
## 16                        IN                                  1830
## 17                        KS                                   751
## 18                        KY                                  1138
## 19                        LA                                  9771
## 20                        MA                                 33900
## 21                        MD                                 17133
## 22                        ME                                   304
## 23                        MI                                 27286
## 24                        MN                                 10537
## 25                        MO                                  1728
## 26                        MS                                  5735
## 27                        MT                                   830
## 28                        NC                                  7824
## 29                        ND                                    97
## 30                        NE                                   137
## 31                        NH                                   238
## 32                        NJ                                 18821
## 33                        NM                                   590
## 34                        NV                                  6848
## 35                        OH                                 14924
## 36                        OK                                  2604
## 37                        OR                                  8361
## 38                        PA                                 27711
## 39                        RI                                  1432
## 40                        SC                                  2102
## 41                        SD                                  1526
## 42                        TN                                  8002
## 43                        TX                                 57781
## 44                        UT                                   235
## 45                        VA                                  6382
## 46                        VT                                   857
## 47                        WA                                 25715
## 48                        WI                                  7115
## 49                        WV                                  4671
## 50                        WY                                   189
##    Total_Premium_Amount Standard_Base_Premium_Number_of_Beneficiaries
## 1               3367444                                           549
## 2              12871090                                          2104
## 3              12149056                                          2009
## 4              21492618                                          3556
## 5            1007115990                                        174128
## 6               5127638                                           784
## 7              14153816                                          2367
## 8              10285159                                          1637
## 9               3870883                                           651
## 10            554796546                                         95729
## 11             12926156                                          2112
## 12             19060239                                          3184
## 13             15842890                                          2630
## 14              2899939                                           477
## 15             27170180                                          4455
## 16              9357238                                          1536
## 17              3934384                                           661
## 18              5899966                                           986
## 19             49690226                                          8135
## 20            179392165                                         30984
## 21             90513865                                         15609
## 22              1483355                                           222
## 23            142034128                                         24053
## 24             55954626                                          9730
## 25              9052735                                          1517
## 26             29309290                                          4837
## 27              4201428                                           683
## 28             40746415                                          6884
## 29               479518                                            75
## 30               694639                                           111
## 31              1200758                                           188
## 32            102073878                                         17246
## 33              3010253                                           482
## 34             35766563                                          6069
## 35             77138312                                         12342
## 36             13293681                                          2183
## 37             43467279                                          7338
## 38            144610451                                         24554
## 39              7402616                                          1239
## 40             10833081                                          1793
## 41              8081001                                          1401
## 42             40909467                                          6743
## 43            297959356                                         49706
## 44              1174401                                           182
## 45             34148479                                          5822
## 46              4347276                                           709
## 47            135711388                                         23390
## 48             36780395                                          6165
## 49             24037269                                          4007
## 50               950935                                           154
##    Standard_Base_Premium_Amount Reduced_Base_Premium_Number_of_Beneficiaries
## 1                       3016388                                          114
## 2                      11564500                                          387
## 3                      11042380                                          364
## 4                      19544692                                          552
## 5                     957008862                                        13597
## 6                       4307032                                          250
## 7                      13009490                                          352
## 8                       8996952                                          419
## 9                       3575606                                           95
## 10                    526124294                                         9291
## 11                     11605720                                          405
## 12                     17497432                                          508
## 13                     14452648                                          455
## 14                      2619760                                           89
## 15                     24486512                                          819
## 16                      8442314                                          294
## 17                      3631940                                           91
## 18                      5417682                                          152
## 19                     44711334                                         1636
## 20                    170289438                                         2916
## 21                     85785232                                         1525
## 22                      1222402                                           82
## 23                    132195746                                         3233
## 24                     53475622                                          807
## 25                      8339722                                          211
## 26                     26585984                                          898
## 27                      3753310                                          147
## 28                     37832632                                          940
## 29                       409910                                           22
## 30                       608224                                           26
## 31                      1032790                                           50
## 32                     94785848                                         1575
## 33                      2646782                                          108
## 34                     33352934                                          780
## 35                     67829800                                         2583
## 36                     11998226                                          421
## 37                     40331480                                         1023
## 38                    134948784                                         3157
## 39                      6810460                                          193
## 40                      9851580                                          309
## 41                      7700354                                          125
## 42                     37058154                                         1259
## 43                    273181428                                         8076
## 44                      1001646                                           53
## 45                     32000002                                          560
## 46                      3896664                                          148
## 47                    128549608                                         2325
## 48                     33881466                                          950
## 49                     22020182                                          664
## 50                       843636                                           35
##    Reduced_Base_Premium_Amount Mean_Discharge Mean_Covered Mean_Total_Payment
## 1                       344736       28.86415    114660.56           24284.33
## 2                      1171044       33.45907     66193.39           13156.24
## 3                      1099980       34.78881     51084.52           12931.13
## 4                      1668240       31.93640     89736.35           16744.43
## 5                     41117580       33.70481    128217.98           21424.59
## 6                       756756       29.79157    109312.56           17935.82
## 7                      1063692       37.31713     60091.54           18870.84
## 8                      1267056       35.29931    110420.26           25532.42
## 9                       286776       45.80507     49654.74           16025.29
## 10                    28097244       36.85355     92664.63           13998.12
## 11                     1223208       33.75845     70106.89           16082.23
## 12                     1535940       29.40800     62408.89           21826.62
## 13                     1374912       35.64845     51942.03           13697.75
## 14                      269388       29.97222     60442.95           15695.67
## 15                     2476404       35.60336     65366.86           15612.97
## 16                      888804       34.60055     62779.78           14266.92
## 17                      273672       37.45637     69649.90           13776.27
## 18                      460404       34.99577     58730.82           13654.93
## 19                     4947012       33.77315     60722.58           14748.47
## 20                     8817732       39.24611     44186.35           17664.33
## 21                     4610088       37.83454     24449.69           22407.09
## 22                      246456       31.62952     45170.88           15402.68
## 23                     9777348       36.36312     48578.70           15803.38
## 24                     2440620       35.46343     54806.81           18148.32
## 25                      637812       34.27291     62431.88           14631.18
## 26                     2715552       37.48513     59269.26           12907.53
## 27                      443268       30.58275     44452.44           14850.12
## 28                     2843316       38.02609     54670.78           15814.85
## 29                       66528       34.50957     45086.67           15480.66
## 30                       79380       33.41988     59629.69           15853.93
## 31                      149940       31.46981     55825.05           15267.30
## 32                     4761540       36.38714    102191.25           16769.92
## 33                      326592       31.86747     64316.23           16331.78
## 34                     2357208       33.72977    124300.07           16346.23
## 35                     7810236       33.54878     56940.05           14564.17
## 36                     1274112       36.68410     68566.42           14220.88
## 37                     3092544       28.10519     57770.03           19002.07
## 38                     9545760       33.46407     80652.28           15732.52
## 39                      583128       31.84740     41724.70           14186.78
## 40                      934668       35.70673     74673.03           15138.29
## 41                      377748       35.98706     52780.26           15166.85
## 42                     3806460       36.55722     64235.86           14528.19
## 43                    24420564       34.76220     91464.19           16330.96
## 44                      160020       30.16100     57048.36           17957.73
## 45                     1693188       37.89901     65882.07           15276.76
## 46                      448056       32.67742     36910.32           11404.49
## 47                     7031808       32.68176     75282.48           18245.77
## 48                     2872548       30.66641     55682.46           15838.85
## 49                     2007936       35.29589     47220.44           13518.60
## 50                      106596       27.13808     45559.24           16289.83
##    Mean_Medicare_Payment
## 1              20744.419
## 2              10636.563
## 3              11165.731
## 4              14281.442
## 5              18811.047
## 6              15280.514
## 7              15676.220
## 8              19320.247
## 9              13095.074
## 10             11935.032
## 11             13258.318
## 12             16682.263
## 13             11820.427
## 14             13378.930
## 15             12762.104
## 16             12379.190
## 17             11727.770
## 18             11323.160
## 19             12403.103
## 20             15643.057
## 21             20607.063
## 22             12836.118
## 23             13267.757
## 24             15353.971
## 25             12850.164
## 26             11196.123
## 27             13091.954
## 28             12929.870
## 29             13173.537
## 30             13493.102
## 31             13232.381
## 32             14133.952
## 33             13891.395
## 34             14068.420
## 35             11702.132
## 36             12075.960
## 37             16207.908
## 38             12614.741
## 39             12050.686
## 40             12537.523
## 41             13671.065
## 42             11703.647
## 43             13641.718
## 44             15171.002
## 45             12285.730
## 46              9413.776
## 47             15005.294
## 48             12861.698
## 49             11049.930
## 50             14289.431</code></pre>
<p>The first difficulty we run into is that the state of our new data set is written in full name, whereas the state of our initial dataset is written in abbreviation; as a result, we need to alter the new data set’s state into abbreviations. Furthermore, since the amount of rows in our original dataset and the amount in our new dataset are different, making it difficult to combine the two, we summarized our initial dataset and grouped it by state, bringing the number of rows into line with the number in our new dataset. Finally, we merge two datasets into a new file called “medicare_premium_combined” using the merge function.</p>
<p>##Output 3</p>
<pre class="r"><code>ggplot(medicare_premium_combined) +
  geom_smooth(aes(x = Total_Premium_Amount/Total_Premium_Number_of_Beneficiaries, y = Mean_Discharge), method = &quot;lm&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>There is a positive linear relationship between the variable “Total_Premium_Amount/Total_Premium_Number_of_Beneficiaries” and “Mean_Discharge”, indicating that as the average premium by person increases, the average discharge by provider also increases. Therefore, this plot implies that the more expensive the premium charged to a beneficiary is, the more frequent the beneficiary will go to the hospital and seek medical care.</p>
<p>##Output 4</p>
<pre class="r"><code>(Combined &lt;- merge(premiumA,medicare_data_sum)) %&gt;% mutate(premium_individual = Total_Premium_Amount/Total_Premium_Number_of_Beneficiaries) %&gt;% 
ggplot() + geom_point(aes(x = reorder(Rndrng_Prvdr_State_Abrvtn,premium_individual),y = premium_individual)) +  scale_x_discrete(guide = guide_axis(n.dodge =2)) + labs(x = &#39;state&#39;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
