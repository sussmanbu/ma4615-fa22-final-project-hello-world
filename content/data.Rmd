---
title: "Data"
description: null
toc: yes
featuredVideo: null
featuredImage: images/Data Page.webp
draft: no
---

# Data Source
In the United States, the government is spending more and more expenditures on healthcare for decades, but there is little healthcare outcomes indicated by the overall health condition of Americans. Also, with the aging of population, a more comprehensive and cost-efficient medical environment for the old is necessary to provide health security for American people. Medicare is a kind of public health insurance designed for people 65 or older, and certain people with disabilities, End-Stage Renal Disease (ESRD), or 
Amyotrophic Lateral Sclerosis (ALS) can get Medicare services earlier. Therefore, in order to learn more about how well Medicare is benefiting the patients treated Inpatient Prospective Payment System (IPPS) hospitals, we decided to focus on the Medicare data of the beneficiaries with Part A fee-for-service coverage. In this project, we want to study what factors can affect the Medicare coverage, as well as how they can influence the percentage of the expenses covered by Medicare.

## Dataset 1
* Link to the original Dataset: https://data.cms.gov/provider-summary-by-type-of-service/medicare-inpatient-hospitals/medicare-inpatient-hospitals-by-provider-and-service
* The first dataset is Medicare Inpatient Hospitals by Provider and Service, which contains detailed information on Rural-Urban Commuting Area (RUCA) codes, Diagnosis Related Group (DRG) category, total discharges, average covered charges by Medicare, total payment, and Medicare payment for the healthcare providers from more than 3,000 hospitals across 51 states in the US. Each row represents a provider with a certain DRG service provided. This dataset is found by our team member Fangzhou Cheng and is collected based on information gathered by Centers for Medicare & Medicaid Services (CMS) for Original Medicare Part A beneficiaries by IPPS hospitals. The primary source of the data is the CMS’s Medicare Provider Analysis and Review (MEDPAR) inpatient data based on fiscal year (October 1st through September 30th). The inpatient provider name and address are derived from CMS’s Provider of Service (POS) data, a resource that provides characteristics associated with institutional facilities. HRRs are geographic units of analysis based on facility location zip codes that were developed by the Dartmouth Atlas of Health Care to delineate regional health care markets in the United States. The data is collected to summarize the information on services and procedures provided to Medicare beneficiaries by hospital facilities.

## Dataset 2
* Link to the original Dataset: https://data.cms.gov/summary-statistics-on-use-and-payments/medicare-premium-reports/cms-program-statistics-medicare-premiums
* The second dataset summarized information on total premium, standard base premium, and reduced base premium for beneficiaries by 51 states across the US. We picked the data from 2020, which is same year as our initial dataset. This dataset is found by our team member Yuke Li and is gathered from CMS data for beneficiaries enrolled in the Medicare program available from the CMS Chronic Conditions Data Warehouse. The data is collected to summarize the premiums that the beneficiaries have to pay for the Medicare services, and we intend to combine this dataset with the first one to analyze the relationship between Medicare coverages and its premiums.

## Dataset 3
* Link to the original Dataset:
https://data.cms.gov/summary-statistics-on-use-and-payments/medicare-geographic-comparisons/medicare-geographic-variation-by-national-state-county/data
* The third dataset is the Geographic Variation of Medicare Services within the U.S. by nation, state, and county. It shows the geographic differences of the use of health care services. This dataset is based on information gathered from CMS administrative enrollment and claims data for Original Medicare beneficiaries available from the CMS Chronic Conditions Data Warehouse. We intend to combine this dataset with our original dataset to make two analysis: the relationship between Medicare Payment and the medical condition in different states; the relationship between the patient readmission rate and Medicare payment.

## Dataset 4
* Link to the original Dataset:
https://www.cms.gov/medicaremedicare-fee-service-paymentphysicianfeeschedpfs-relative-value-files/rvu20d
* This dataset is an additional dataset based on the final rule of Medicare Physician Fee Schedule(PFS). It is issued by CMS aiming to expand access to behavioral health care, cancer screening coverage, and dental care. Different from the original one, this dataset provides relative values of the payments under Medicare Physician Fee Schedule(PFS). We intend to include this dataset to analyze the ... We have also included 2018 and 2019 version of this dataset. We aim to find some changes across the timeline.

## Dataset 5
* Link to the original Dataset:
https://data.cms.gov/summary-statistics-on-use-and-payments/medicare-service-type-reports/cms-program-statistics-medicare-advantage-inpatient-hospital
* This dataset summarized information on inpatient hospital use for Medicare Advantage beneficiaries, by type of entitlement, type of hospital, demographics, and geography. The data reported in these inpatient hospital tables are based on information gathered from inpatient hospital encounter records for beneficiaries enrolled in Medicare Advantage available from the CMS Chronic Conditions Data Warehouse. We intend to use this dataset to analyze the relationship between patients' length of stay at hospital and the medicare coverage.

## Dataset 6
* Link to the original Dataset:
https://www.americashealthrankings.org/explore/annual/measure/Health_Status/state/ALL?edition-year=2020
*  This dataset shows each state's statistics about the percentage of adults who reported that their health was very good or excellent. The dataset is provided by CDC, Behavioral Risk Factor Surveillance System aiming to find out how individuals perceive their own health. The self perceive health status could be a good measure for government medicare policy since it reflects people's health-related quality of life. We intend to join this dataset with the original dataset to analyze if there's any connection in between.

# Variables
* `Rndrng_Prvdr_Org_Name`: Rendering provider name; name of the provider.
* `Rndrng_Prvdr_City`: Rendering provider city; the city in which the provider is physically located.
* `Rndrng_Prvdr_State_Abrvtn`: Rendering provider state abbreviation; the state abbreviation for the state in which the provider is physically located.
* `Rndrng_Prvdr_RUCA`: Rendering provider rural-urban commuting area(RUCA) codes; RUCA code for which the provider is physically located. RUCA code classify zip codes as rural/urban areas based on measures of population density, level of urbanization, and daily commuting patterns. The smaller the code, the more urbanize the area.
* `DRG_Cd`: Diagnosis Related Group (DRG) definition; groups similar clinical conditions
* `DRG_Desc`: DRG description; description of DRG_Cd.
* `Tot_Dschrgs`: Total discharges; measures the number of discharges billed by all providers for inpatient hospital services. (for each hospital)
* `Avg_Submtd_Cvrd_Chrg`: Average covered charges; the average charge of all providers' services covered by Medicare for discharges in the DRG.(for each hospital)
* `Avg_Tot_Pymt_Amt`: Average total payments; the average total payments to all providers for the DRG. (for each hospital)
* `Avg_Mdcr_Pymt_Amt`: Average medicare payments; the average amount that Medicare pays to the provider for Medicare's share of the MS-DRG. (for each hospital)
*`Mean_Discharge`: The mean value of total number of patient discharges for each state; A processed variable based on `Tot_Dschrgs`.
* `Mean_Covered`: The mean value of covered payments for each state; A processed variable based on `Avg_Submtd_Cvrd_Chrg`.
* `Mean_Total_Payment`: The mean value of total payments for each state; A processed variable based on `Avg_Tot_Pymt_Amt`.
*`Mean_Medicare_Payment`: The mean value of medicare payments for each state; A processed variable based on `Avg_Mdcr_Pymt_Amt`.
* `Total_Premium_Number_of_Beneficiaries`: Number of Medicare beneficiaries who have the pay Part A premium; individuals who enrolled in Medicare Part A but did not have at least 40 quarters of Medicare-covered employment. 
* `Total_Premium_Amount`: Total Medicare part A premium paid in a given state.
* `Standard_Base_Premium_Number_of_Beneficiaries`: Individuals who enrolled in Medicare Part A but did not have at least 30 quarters of Medicare-covered employment. 
* `Standard_Base_Premium_Amount`: Total Medicare part A standard premium paid in a given state.
* `Reduced_Base_Premium_Number_of_Beneficiaries`: Individuals who had at least 30 quarters of coverage or were married to someone with at least 30 quarters of coverage may buy into Part A with reduced premium.
* `Reduced_Base_Premium_Amount`: Total Medicare part A reduced premium paid in a given state.
*`BENE_AVG_RISK_SCRE`: Average HCC Score; average Hierarchical Condition Category Score (HCC Score).
* `ACUTE_HOSP_READMSN_PCT`: Hospital Readmission Rate; percent of inpatient readmission within 30 days of an acute hospital stay during the reference period, where the reference period refers to an inpatient hospital stay during the calendar year.
*`BENE_AGE_LVL`: Age level; All Beneficiaries, Beneficiaries under 65, or Beneficiaries 65 or older.
* `BENE_GEO_LVL`:Geographic Level;National, State, County, or HRR.
* `BENE_GEO_DESC`: HRR; Name of HRR.
* `Avg_LOS`: Average Length of Stay; The average days the patients would stay in hospitals for each state.
* `Health_Status`: Percentage of adults who reported that their health was very good or excellent.

# Data Import and Cleaning
In [load_and_clean_data.R](https://hello-world-415.netlify.app/load_and_clean_data.R), we loaded and cleaned our datasets:

## The first dataset: Medicare Inpatient Hospitals - by Provider and Service
The size of our dataset is smaller than 50 mb so we included Medicare_Data.csv file in the dataset folder. We loaded the data using read_csv and cleaned the data by removing rows with missing values. We also removed columns with meaningless information for our analysis. 

We first discussed to identify the columns we need for this project. After selecting the required columns for our datasets, we created another global variable dataset by filtering out those datasets with missing and abnormal values. There are mainly two types of missing values in our datasets – “NA” and “Unknown”. “Unknown” only appears in the RUCA variable and “NA” only appears in the numeric value. After dropping these values, we made some further decisions on the columns that will be needed for our EDA process. In the end, we dropped those variables with repetitive meanings such as the name and code for providers. After testing the availability of the test and making some basic coding on the cleaned dataset, we created our finalized dataset for future usage.
 
## The second dataset: CMS Program Statistics - Medicare Premiums
While merging the cleaned first dataset with other datasets, we summarized and categorized the data based on the number of states that’s been recorded. During the merging process, we identified the disparity between data that some columns in the second raw datasets utilized a different data type which made the merge incompatible. We then unified the data formats and deleted the dollar signs and commas in the raw datasets in the Excel file. To make sure we can conveniently apply the dataset in the future, we recorded the file under CSV format and finalized the merging data into another file.

## The third dataset: Geographic Variation of Medicare Services
For this dataset, we are interested in the relationship between medicare payment and the geographic location where medicare services are implemented. We first summarized what we can find as useful information in this dataset. Based on the evaluation we made, we found two variables HCC and Readmission Rate that could best show the performance of medicare. After sorting out missing and ineffective values, we took these two columns of data out from the dataset and used the inner-join function to create a new dataframe so that we can practice analysis based on the data. 

## The fourth dataset: CMS Program Statistics - Medicare Advantage-Inpatient Hospital
In the research of this dataset, we wanted to know how length of stay of patients could possibly relate to medicare payment. To make the study of this dataset easier, we first created a global dataframe from the original dataset of medicare payment. We used the function group_by to create a dataset that shows the value given by each state. After this, we selected out the variable we needed from this dataset and merged it with the processed version of original dataset. It gave us a result that's based on each state.

The by-state dataset was then saved for further usage for other datasets like Health Status.

## The fifth dataset: American Health Rankings
People's personal perception to their health status could be a good implication of how well the medicare services are implemented. For this dataset, we intend to show the relationship between these factors. Fortunately, this dataset has already summed up a variable that tells us what percentage of population perceive themselves to be healthy in each state. After taking out columns we needed from the raw dataset, we used a left-join based on each state. 

## The sixth dataset: GDP
[...]

# Datasets Combination
```{r}
suppressPackageStartupMessages(library(tidyverse))

premiumA <- read_csv(here::here("dataset", "PremiumA.csv"), 
                     col_types = cols(Total_Premium_Amount =col_number(),  
                    Reduced_Base_Premium_Amount=col_number(), 
                    Standard_Base_Premium_Amount = col_number()))

medicare_data_clean <- read_csv(here::here("dataset", "Medicare_Data_clean.csv"))
medicare_data_sum<- medicare_data_clean %>%
  group_by(Rndrng_Prvdr_State_Abrvtn) %>%
  summarize(Mean_Discharge = mean(Tot_Dschrgs), 
            Mean_Covered = mean(Avg_Submtd_Cvrd_Chrg), 
            Mean_Total_Payment = mean(Avg_Tot_Pymt_Amt), 
            Mean_Medicare_Payment = mean(Avg_Mdcr_Pymt_Amt))
medicare_premium_combined <- merge(premiumA,medicare_data_sum) %>%
    mutate(premium_individual = Total_Premium_Amount/Total_Premium_Number_of_Beneficiaries)

write_csv(medicare_premium_combined, file = here::here("dataset", "origin_with_premium_state.csv"))
save(medicare_premium_combined, file = here::here("dataset/origin_with_premium_state.csv.RData"))

origin_with_premium <- medicare_data_clean %>%
  left_join(premiumA,by="Rndrng_Prvdr_State_Abrvtn",all=TRUE)
write_csv(origin_with_premium, file = here::here("dataset", "origin_with_premium.csv"))
save(origin_with_premium, file = here::here("dataset/origin_with_premium.csv.RData"))

health_status_state <- read.csv(here::here("dataset", "Health_Status_2020.csv"))
colnames(health_status_state)[1] = "Rndrng_Prvdr_State_Abrvtn"
origin_with_hs_state <- medicare_data_sum %>%
  left_join(health_status_state,by="Rndrng_Prvdr_State_Abrvtn",all=TRUE)
write_csv(origin_with_hs_state, file = here::here("dataset", "origin_with_hs_state.csv"))
save(origin_with_hs_state, file = here::here("dataset/origin_with_hs_state.csv.RData"))

origin_with_hs <- medicare_data_clean %>%
  left_join(health_status_state,by="Rndrng_Prvdr_State_Abrvtn",all=TRUE)
write_csv(origin_with_hs, file = here::here("dataset", "origin_with_hs.csv"))
save(origin_with_hs, file = here::here("dataset/origin_with_hs.csv.RData"))

```

```{r}
data19 <- read_csv(here::here("dataset", "medicare-19.csv"),col_types = cols(Avg_Mdcr_Pymt_Amt=col_number(), Avg_Tot_Pymt_Amt=col_number(), Avg_Submtd_Cvrd_Chrg=col_number()))
data_clean19 <- data19 %>% filter(!grepl('Unknown', data19$Rndrng_Prvdr_RUCA_Desc)) %>% drop_na() %>% select(-Rndrng_Prvdr_CCN, -Rndrng_Prvdr_St, -Rndrng_Prvdr_State_FIPS, -Rndrng_Prvdr_Zip5, -Rndrng_Prvdr_RUCA_Desc) 
datasum19<- medicare_data_clean %>%
  rename('state'='Rndrng_Prvdr_State_Abrvtn') %>%
  group_by(state) %>%
  summarize(Mean_Discharge = mean(Tot_Dschrgs), 
            Mean_Covered = mean(Avg_Submtd_Cvrd_Chrg), 
            Mean_Total_Payment = mean(Avg_Tot_Pymt_Amt), 
            Mean_Medicare_Payment = mean(Avg_Mdcr_Pymt_Amt))
Avg_LOS19 <- read_csv(here::here("dataset", "Avg_LOS19.csv"))
LOS_plot19 <- merge(datasum19, Avg_LOS19, by = "state")
LOS_plot19 <- LOS_plot19 %>% mutate(Medicare_Coverage = Mean_Medicare_Payment/Mean_Total_Payment)
LOS_plot19$year <- c(2019)

data18 <- read_csv(here::here("dataset", "medicare-18.csv"))
data18 <- read_csv(here::here("dataset", "medicare-18.csv"),col_types = cols(Avg_Mdcr_Pymt_Amt=col_number(), Avg_Tot_Pymt_Amt=col_number(), Avg_Submtd_Cvrd_Chrg=col_number()))
data_clean18 <- data18 %>% filter(!grepl('Unknown', data18$Rndrng_Prvdr_RUCA_Desc)) %>% drop_na() %>% select(-Rndrng_Prvdr_CCN, -Rndrng_Prvdr_St, -Rndrng_Prvdr_State_FIPS, -Rndrng_Prvdr_Zip5, -Rndrng_Prvdr_RUCA_Desc) 
colnames(data_clean18)[3] ="state"
datasum18<- medicare_data_clean %>%
  rename('state'='Rndrng_Prvdr_State_Abrvtn') %>%
  group_by(state) %>%
  summarize(Mean_Discharge = mean(Tot_Dschrgs), 
            Mean_Covered = mean(Avg_Submtd_Cvrd_Chrg), 
            Mean_Total_Payment = mean(Avg_Tot_Pymt_Amt), 
            Mean_Medicare_Payment = mean(Avg_Mdcr_Pymt_Amt))

Avg_LOS18 <- read_csv(here::here("dataset", "Avg_LOS.csv"))
LOS_plot18 <- merge(datasum18, Avg_LOS18, by = "state")
LOS_plot18 <- LOS_plot18 %>% mutate(Medicare_Coverage = Mean_Medicare_Payment/Mean_Total_Payment)
LOS_plot18$year <- c(2018)


data17 <- read_csv(here::here("dataset", "medicare-17.csv"))
data17 <- read_csv(here::here("dataset", "medicare-17.csv"),col_types = cols(Avg_Mdcr_Pymt_Amt=col_number(), Avg_Tot_Pymt_Amt=col_number(), Avg_Submtd_Cvrd_Chrg=col_number()))
data_clean17 <- data17 %>% filter(!grepl('Unknown', data17$Rndrng_Prvdr_RUCA_Desc)) %>% drop_na() %>% select(-Rndrng_Prvdr_CCN, -Rndrng_Prvdr_St, -Rndrng_Prvdr_State_FIPS, -Rndrng_Prvdr_Zip5, -Rndrng_Prvdr_RUCA_Desc) 
colnames(data_clean17)[3] ="state"
datasum17<- medicare_data_clean %>%
  rename('state'='Rndrng_Prvdr_State_Abrvtn') %>%
  group_by(state) %>%
  summarize(Mean_Discharge = mean(Tot_Dschrgs), 
            Mean_Covered = mean(Avg_Submtd_Cvrd_Chrg), 
            Mean_Total_Payment = mean(Avg_Tot_Pymt_Amt), 
            Mean_Medicare_Payment = mean(Avg_Mdcr_Pymt_Amt))

Avg_LOS17 <- read_csv(here::here("dataset", "Avg_LOS17.csv"))
LOS_plot17 <- merge(datasum17, Avg_LOS17, by = "state")
LOS_plot17 <- LOS_plot17 %>% mutate(Medicare_Coverage = Mean_Medicare_Payment/Mean_Total_Payment)
LOS_plot17$year <- c(2017)

data16 <- read_csv(here::here("dataset", "medicare-16.csv"))
data16 <- read_csv(here::here("dataset", "medicare-16.csv"),col_types = cols(Avg_Mdcr_Pymt_Amt=col_number(), Avg_Tot_Pymt_Amt=col_number(), Avg_Submtd_Cvrd_Chrg=col_number()))
data_clean16 <- data16 %>% filter(!grepl('Unknown', data16$Rndrng_Prvdr_RUCA_Desc)) %>% drop_na() %>% select(-Rndrng_Prvdr_CCN, -Rndrng_Prvdr_St, -Rndrng_Prvdr_State_FIPS, -Rndrng_Prvdr_Zip5, -Rndrng_Prvdr_RUCA_Desc) 
colnames(data_clean16)[3] ="state"
datasum16<- medicare_data_clean %>%
  rename('state'='Rndrng_Prvdr_State_Abrvtn') %>%
  group_by(state) %>%
  summarize(Mean_Discharge = mean(Tot_Dschrgs), 
            Mean_Covered = mean(Avg_Submtd_Cvrd_Chrg), 
            Mean_Total_Payment = mean(Avg_Tot_Pymt_Amt), 
            Mean_Medicare_Payment = mean(Avg_Mdcr_Pymt_Amt))

Avg_LOS16 <- read_csv(here::here("dataset", "Avg_LOS16.csv"))
LOS_plot16 <- merge(datasum16, Avg_LOS16, by = "state")
LOS_plot16 <- LOS_plot16 %>% mutate(Medicare_Coverage = Mean_Medicare_Payment/Mean_Total_Payment)
LOS_plot16$year <- c(2016)

```
```{r}
### merge 18 and 19
total <- rbind(LOS_plot16,LOS_plot17,LOS_plot18, LOS_plot19)
write_csv(total, file = here::here("dataset", "total.csv"))
```


# References
* Centers for Medicare &amp; Medicaid Services. “Medicare Inpatient Hospitals - by Provider and Service.” Centers for Medicare &amp; Medicaid Services Data, 2022, https://data.cms.gov/provider-summary-by-type-of-service/medicare-inpatient-hospitals/medicare-inpatient-hospitals-by-provider-and-service. 
* Centers for Medicare &amp; Medicaid Services. “CMS Program Statistics - Medicare Premiums.” Centers for Medicare &amp; Medicaid Services Data, 2022, https://data.cms.gov/summary-statistics-on-use-and-payments/medicare-premium-reports/cms-program-statistics-medicare-premiums. 
* Kurani, Nisha, et al. “How Has U.S. Spending on Healthcare Changed over Time?” Peterson-KFF Health System Tracker, 25 Feb. 2022, https://www.healthsystemtracker.org/chart-collection/u-s-spending-healthcare-changed-time/#Total%20national%20health%20expenditures,%20US%20$%20Billions,%201970-2020. 
* Juliette Cubanski and Tricia Neuman, The Facts on Medicare Spending and Financing, (KFF, 20 Aug. 2019) https://www.kff.org/medicare/issue-brief/the-facts-on-medicare-spending-and-financing/ (21 Nov. 2022)
* Medicare Geographic Variation - by National, State & County, 2020,
https://data.cms.gov/summary-statistics-on-use-and-payments/medicare-geographic-comparisons/medicare-geographic-variation-by-national-state-county/data
* Physician Fee Schedule Value Files, 2020,
https://www.cms.gov/medicaremedicare-fee-service-paymentphysicianfeeschedpfs-relative-value-files/rvu20d
* Physician Fee Schedule Value Files, 2019,
https://www.cms.gov/Medicare/Medicare-Fee-for-Service-Payment/PhysicianFeeSched/PFS-Relative-Value-Files-Items/RVU19C
* Physician Fee Schedule Value Files, 2018,
https://www.cms.gov/Medicare/Medicare-Fee-for-Service-Payment/PhysicianFeeSched/PFS-Relative-Value-Files-Items/RVU18D
* CMS Program Statistics - Medicare Advantage-Inpatient Hospital, 2019,
https://data.cms.gov/summary-statistics-on-use-and-payments/medicare-service-type-reports/cms-program-statistics-medicare-advantage-inpatient-hospital 
* American Health Rankings, High Health Status, 2020,
https://www.americashealthrankings.org/explore/annual/measure/Health_Status/state/ALL?edition-year=2020
* American Health Rankings, High Health Status, 2019,
https://www.americashealthrankings.org/explore/annual/measure/Health_Status/state/ALL?edition-year=2019
* American Health Rankings, High Health Status, 2018,
https://www.americashealthrankings.org/explore/annual/measure/Health_Status/state/ALL?edition-year=2018

* [GDP reference]

