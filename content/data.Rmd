---
title: Data
description:
toc: true
featuredVideo:
featuredImage: images/Data Page.webp
draft: false
---

# Data Source
In the United States, the government is spending more and more expenditures on healthcare for decades, but there is little healthcare outcomes indicated by the overall health condition of Americans. Also, with the aging of population, a more comprehensive and cost-efficient medical environment for the old is necessary to provide health security for American people. Medicare is a kind of public health insurance designed for people 65 or older, and certain people with disabilities, End-Stage Renal Disease (ESRD), or 
Amyotrophic Lateral Sclerosis (ALS) can get Medicare services earlier. Therefore, in order to learn more about how well Medicare is benefiting the patients treated Inpatient Prospective Payment System (IPPS) hospitals, we decided to focus on the Medicare data of the beneficiaries with Part A fee-for-service coverage. In this project, we want to study what factors can affect the Medicare coverage, as well as how they can influence the percentage of the expenses covered by Medicare.

## Dataset 1
* Link to the original dataset: https://data.cms.gov/provider-summary-by-type-of-service/medicare-inpatient-hospitals/medicare-inpatient-hospitals-by-provider-and-service
* The first dataset is Medicare Inpatient Hospitals by Provider and Service, which contains detailed information on Rural-Urban Commuting Area (RUCA) codes, Diagnosis Related Group (DRG) category, total discharges, average covered charges by Medicare, total payment, and Medicare payment for the healthcare providers from more than 3,000 hospitals across 51 states in the US. Each row represents a provider with a certain DRG service provided. This dataset is found by our team member Fangzhou Cheng and is collected based on information gathered by Centers for Medicare & Medicaid Services (CMS) for Original Medicare Part A beneficiaries by IPPS hospitals. The primary source of the data is the CMS’s Medicare Provider Analysis and Review (MEDPAR) inpatient data based on fiscal year (October 1st through September 30th). The inpatient provider name and address are derived from CMS’s Provider of Service (POS) data, a resource that provides characteristics associated with institutional facilities. HRRs are geographic units of analysis based on facility location zip codes that were developed by the Dartmouth Atlas of Health Care to delineate regional health care markets in the United States. The data is collected to summarize the information on services and procedures provided to Medicare beneficiaries by hospital facilities.

## Dataset 2
* Link to the original dataset: https://data.cms.gov/summary-statistics-on-use-and-payments/medicare-premium-reports/cms-program-statistics-medicare-premiums
* The second dataset summarized information on total premium, standard base premium, and reduced base premium for beneficiaries by 51 states across the US. We picked the data from 2020, which is same year as our initial dataset. This dataset is found by our team member Yuke Li and is gathered from CMS data for beneficiaries enrolled in the Medicare program available from the CMS Chronic Conditions Data Warehouse. The data is collected to summarize the premiums that the beneficiaries have to pay for the Medicare services, and we intend to combine this dataset with the first one to analyze the relationship between Medicare coverages and its premiums.

# Variables
* Rndrng_Prvdr_Org_Name: rendering provider name; name of the provider.
* Rndrng_Prvdr_City: rendering provider city; the city in which the provider is physically located.
* Rndrng_Prvdr_State_Abrvtn: rendering provider state abbreviation; the state abbreviation for the state in which the provider is physically located.
* Rndrng_Prvdr_RUCA: rendering provider rural-urban commuting area(RUCA) codes; RUCA code for which the provider is physically located. RUCA code classify zip codes as rural/urban areas based on measures of population density, level of urbanization, and daily commuting patterns. The smaller the code, the more urbanize the area.
* DRG_Cd: Diagnosis Related Group (DRG) definition; groups similar clinical conditions
* DRG_Desc: DRG description;description of DRG_Cd.
* Tot_Dschrgs: total discharges; measures the number of discharges billed by all providers for inpatient hospital services.
* Avg_Submtd_Cvrd_Chrg: average covered charges; the average charge of all providers' services covered by Medicare for discharges in the DRG.
* Avg_Tot_Pymt_Amt: average total payments; The average total payments to all providers for the DRG.
* Avg_Mdcr_Pymt_Amt: average medicare payments; the average amount that Medicare pays to the provider for Medicare's share of the MS-DRG. 
* Total_Premium_Number_of_Beneficiaries: number of Medicare beneficiaries who have the pay Part A premium; individuals who enrolled in Medicare Part A but did not have at least 40 quarters of Medicare-covered employment. 
* Total_Premium_Amount: total Medicare part A premium paid in a given state 
* Standard_Base_Premium_Number_of_Beneficiaries: individuals who enrolled in Medicare Part A but did not have at least 30 quarters of Medicare-covered employment. 
* Standard_Base_Premium_Amount: total Medicare part A standard premium paid in a given state 
* Reduced_Base_Premium_Number_of_Beneficiaries: individuals who had at least 30 quarters of coverage or were married to someone with at least 30 quarters of coverage may buy into Part A with reduced premium 
* Reduced_Base_Premium_Amount: total Medicare part A reduced premium paid in a given state 

# Data Import and Cleaning
In [load_and_clean_data.R](https://hello-world-415.netlify.app/load_and_clean_data.R), we loaded and cleaned our datasets:

## The first dataset: Medicare Inpatient Hospitals - by Provider and Service
The size of our dataset is smaller than 50 mb so we included Medicare_Data.csv file in the dataset folder. We loaded the data using read_csv and cleaned the data by removing rows with missing values. We also removed columns with meaningless information for our analysis. 
We first discussed to identify the columns we need for this project. After selecting the required columns for our datasets, we created another global variable dataset by filtering out those datasets with missing and abnormal values. There are mainly two types of missing values in our datasets – “NA” and “Unknown”. “Unknown” only appears in the RUCA variable and “NA” only appears in the numeric value. After dropping these values, we made some further decisions on the columns that will be needed for our EDA process. In the end, we dropped those variables with repetitive meanings such as the name and code for providers. After testing the availability of the test and making some basic coding on the cleaned dataset, we created our finalized dataset for future usage.
 
## The second dataset: CMS Program Statistics - Medicare Premiums
While merging the cleaned first dataset with other datasets, we summarized and categorized the data based on the number of states that’s been recorded. During the merging process, we identified the disparity between data that some columns in the second raw datasets utilized a different data type which made the merge incompatible. We then unified the data formats and deleted the dollar signs and commas in the raw datasets in the Excel file. To make sure we can conveniently apply the dataset in the future, we recoded the file under CSV format and finalized the merging data into another file.

# Datasets Combination
In order to combine the two datasets, we used function `group_by` to sort the first dataset by states , and used function `merge()` to add the second dataset to the first dataset. After combining the two datasets, we added a new variable called “premium_individual” which is the average premium amount per person in order to analyze how it can influence the Medicare coverage.
```{r}
suppressPackageStartupMessages(library(tidyverse))

premiumA <- read_csv(here::here("dataset", "PremiumA.csv"), 
                     col_types = cols(Total_Premium_Amount =col_number(),  
                    Reduced_Base_Premium_Amount=col_number(), 
                    Standard_Base_Premium_Amount = col_number()))

medicare_data_clean <- read_csv(here::here("dataset", "Medicare_Data_clean.csv"))
medicare_data_sum<- medicare_data_clean %>%
  group_by(Rndrng_Prvdr_State_Abrvtn) %>%
  summarize(Mean_Discharge = mean(Tot_Dschrgs), 
            Mean_Covered = mean(Avg_Submtd_Cvrd_Chrg), 
            Mean_Total_Payment = mean(Avg_Tot_Pymt_Amt), 
            Mean_Medicare_Payment = mean(Avg_Mdcr_Pymt_Amt))
medicare_premium_combined <- merge(premiumA,medicare_data_sum) %>%
    mutate(premium_individual = Total_Premium_Amount/Total_Premium_Number_of_Beneficiaries)

write_csv(medicare_premium_combined, file = here::here("dataset", "origin_with_premium_state.csv"))
save(medicare_premium_combined, file = here::here("dataset/origin_with_premium_state.csv.RData"))

origin_with_premium <- medicare_data_clean %>%
  left_join(premiumA,by="Rndrng_Prvdr_State_Abrvtn",all=TRUE)
write_csv(origin_with_premium, file = here::here("dataset", "origin_with_premium.csv"))
save(origin_with_premium, file = here::here("dataset/origin_with_premium.csv.RData"))

health_status_state <- read.csv(here::here("dataset", "Health_Status_2020.csv"))
colnames(health_status_state)[1] = "Rndrng_Prvdr_State_Abrvtn"
origin_with_hs_state <- medicare_data_sum %>%
  left_join(health_status_state,by="Rndrng_Prvdr_State_Abrvtn",all=TRUE)
write_csv(origin_with_hs_state, file = here::here("dataset", "origin_with_hs_state.csv"))
save(origin_with_hs_state, file = here::here("dataset/origin_with_hs_state.csv.RData"))

origin_with_hs <- medicare_data_clean %>%
  left_join(health_status_state,by="Rndrng_Prvdr_State_Abrvtn",all=TRUE)
write_csv(origin_with_hs, file = here::here("dataset", "origin_with_hs.csv"))
save(origin_with_hs, file = here::here("dataset/origin_with_hs.csv.RData"))

```
```{r}
origin_with_hs %>%
  mutate(coverage=)

```

```{r}
data19 <- read_csv(here::here("dataset", "medicare-19.csv"),col_types = cols(Avg_Mdcr_Pymt_Amt=col_number(), Avg_Tot_Pymt_Amt=col_number(), Avg_Submtd_Cvrd_Chrg=col_number()))
data_clean19 <- data19 %>% filter(!grepl('Unknown', data19$Rndrng_Prvdr_RUCA_Desc)) %>% drop_na() %>% select(-Rndrng_Prvdr_CCN, -Rndrng_Prvdr_St, -Rndrng_Prvdr_State_FIPS, -Rndrng_Prvdr_Zip5, -Rndrng_Prvdr_RUCA_Desc) 
datasum19<- medicare_data_clean %>%
  group_by(state) %>%
  summarize(Mean_Discharge = mean(Tot_Dschrgs), 
            Mean_Covered = mean(Avg_Submtd_Cvrd_Chrg), 
            Mean_Total_Payment = mean(Avg_Tot_Pymt_Amt), 
            Mean_Medicare_Payment = mean(Avg_Mdcr_Pymt_Amt))
Avg_LOS19 <- read_csv(here::here("dataset", "Avg_LOS19.csv"))
LOS_plot19 <- merge(datasum19, Avg_LOS19, by = "state")
LOS_plot19 <- LOS_plot19 %>% mutate(Medicare_Coverage = Mean_Medicare_Payment/Mean_Total_Payment)
LOS_plot19$year <- c(2019)

data18 <- read_csv(here::here("dataset", "medicare-18.csv"))
data18 <- read_csv(here::here("dataset", "medicare-18.csv"),col_types = cols(Avg_Mdcr_Pymt_Amt=col_number(), Avg_Tot_Pymt_Amt=col_number(), Avg_Submtd_Cvrd_Chrg=col_number()))
data_clean18 <- data18 %>% filter(!grepl('Unknown', data18$Rndrng_Prvdr_RUCA_Desc)) %>% drop_na() %>% select(-Rndrng_Prvdr_CCN, -Rndrng_Prvdr_St, -Rndrng_Prvdr_State_FIPS, -Rndrng_Prvdr_Zip5, -Rndrng_Prvdr_RUCA_Desc) 
colnames(data_clean18)[3] ="state"
datasum18<- medicare_data_clean %>%
  group_by(state) %>%
  summarize(Mean_Discharge = mean(Tot_Dschrgs), 
            Mean_Covered = mean(Avg_Submtd_Cvrd_Chrg), 
            Mean_Total_Payment = mean(Avg_Tot_Pymt_Amt), 
            Mean_Medicare_Payment = mean(Avg_Mdcr_Pymt_Amt))

Avg_LOS18 <- read_csv(here::here("dataset", "Avg_LOS.csv"))
LOS_plot18 <- merge(datasum18, Avg_LOS18, by = "state")
LOS_plot18 <- LOS_plot18 %>% mutate(Medicare_Coverage = Mean_Medicare_Payment/Mean_Total_Payment)
LOS_plot18$year <- c(2018)


data17 <- read_csv(here::here("dataset", "medicare-17.csv"))
data17 <- read_csv(here::here("dataset", "medicare-17.csv"),col_types = cols(Avg_Mdcr_Pymt_Amt=col_number(), Avg_Tot_Pymt_Amt=col_number(), Avg_Submtd_Cvrd_Chrg=col_number()))
data_clean17 <- data17 %>% filter(!grepl('Unknown', data17$Rndrng_Prvdr_RUCA_Desc)) %>% drop_na() %>% select(-Rndrng_Prvdr_CCN, -Rndrng_Prvdr_St, -Rndrng_Prvdr_State_FIPS, -Rndrng_Prvdr_Zip5, -Rndrng_Prvdr_RUCA_Desc) 
colnames(data_clean17)[3] ="state"
datasum17<- medicare_data_clean %>%
  group_by(state) %>%
  summarize(Mean_Discharge = mean(Tot_Dschrgs), 
            Mean_Covered = mean(Avg_Submtd_Cvrd_Chrg), 
            Mean_Total_Payment = mean(Avg_Tot_Pymt_Amt), 
            Mean_Medicare_Payment = mean(Avg_Mdcr_Pymt_Amt))

Avg_LOS17 <- read_csv(here::here("dataset", "Avg_LOS17.csv"))
LOS_plot17 <- merge(datasum17, Avg_LOS17, by = "state")
LOS_plot17 <- LOS_plot17 %>% mutate(Medicare_Coverage = Mean_Medicare_Payment/Mean_Total_Payment)
LOS_plot17$year <- c(2017)

data16 <- read_csv(here::here("dataset", "medicare-16.csv"))
data16 <- read_csv(here::here("dataset", "medicare-16.csv"),col_types = cols(Avg_Mdcr_Pymt_Amt=col_number(), Avg_Tot_Pymt_Amt=col_number(), Avg_Submtd_Cvrd_Chrg=col_number()))
data_clean16 <- data16 %>% filter(!grepl('Unknown', data16$Rndrng_Prvdr_RUCA_Desc)) %>% drop_na() %>% select(-Rndrng_Prvdr_CCN, -Rndrng_Prvdr_St, -Rndrng_Prvdr_State_FIPS, -Rndrng_Prvdr_Zip5, -Rndrng_Prvdr_RUCA_Desc) 
colnames(data_clean16)[3] ="state"
datasum16<- medicare_data_clean %>%
  group_by(state) %>%
  summarize(Mean_Discharge = mean(Tot_Dschrgs), 
            Mean_Covered = mean(Avg_Submtd_Cvrd_Chrg), 
            Mean_Total_Payment = mean(Avg_Tot_Pymt_Amt), 
            Mean_Medicare_Payment = mean(Avg_Mdcr_Pymt_Amt))

Avg_LOS16 <- read_csv(here::here("dataset", "Avg_LOS16.csv"))
LOS_plot16 <- merge(datasum16, Avg_LOS16, by = "state")
LOS_plot16 <- LOS_plot16 %>% mutate(Medicare_Coverage = Mean_Medicare_Payment/Mean_Total_Payment)
LOS_plot16$year <- c(2016)

```
```{r}
### merge 18 and 19
total <- rbind(LOS_plot16,LOS_plot17,LOS_plot18, LOS_plot19)
write_csv(total, file = here::here("dataset", "total.csv"))
```


# References
* Centers for Medicare &amp; Medicaid Services. “Medicare Inpatient Hospitals - by Provider and Service.” Centers for Medicare &amp; Medicaid Services Data, 2022, https://data.cms.gov/provider-summary-by-type-of-service/medicare-inpatient-hospitals/medicare-inpatient-hospitals-by-provider-and-service. 
* Centers for Medicare &amp; Medicaid Services. “CMS Program Statistics - Medicare Premiums.” Centers for Medicare &amp; Medicaid Services Data, 2022, https://data.cms.gov/summary-statistics-on-use-and-payments/medicare-premium-reports/cms-program-statistics-medicare-premiums. 
* Kurani, Nisha, et al. “How Has U.S. Spending on Healthcare Changed over Time?” Peterson-KFF Health System Tracker, 25 Feb. 2022, https://www.healthsystemtracker.org/chart-collection/u-s-spending-healthcare-changed-time/#Total%20national%20health%20expenditures,%20US%20$%20Billions,%201970-2020. 
* Juliette Cubanski and Tricia Neuman, The Facts on Medicare Spending and Financing, (KFF, 20 Aug. 2019) https://www.kff.org/medicare/issue-brief/the-facts-on-medicare-spending-and-financing/ (21 Nov. 2022)
